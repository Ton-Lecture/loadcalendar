<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendar Chatbot Assistant</title>
    
    <!-- 1. Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. Load React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    
    <!-- 3. Load Babel (to compile JSX in browser) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Font import (Optional for better look) -->
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Sarabun', sans-serif; }
        /* Simple fade animation */
        .fade-in { animation: fadeIn 0.2s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body class="bg-slate-50">

    <!-- Container for React App -->
    <div id="root"></div>

    <!-- React Logic -->
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- Icon Components ---
        const Icon = ({ path, className, size = 24 }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width={size} 
                height={size} 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className}
            >
                {path}
            </svg>
        );

        const Icons = {
            Send: (props) => <Icon {...props} path={<><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></>} />,
            Calendar: (props) => <Icon {...props} path={<><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></>} />,
            Clock: (props) => <Icon {...props} path={<><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></>} />,
            Trash2: (props) => <Icon {...props} path={<><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></>} />,
            User: (props) => <Icon {...props} path={<><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></>} />,
            Bot: (props) => <Icon {...props} path={<><rect x="3" y="11" width="18" height="10" rx="2"/><circle cx="12" cy="5" r="2"/><path d="M12 7v4"/><line x1="8" y1="16" x2="8" y2="16"/><line x1="16" y1="16" x2="16" y2="16"/></>} />,
            PlusCircle: (props) => <Icon {...props} path={<><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></>} />,
            CalendarDays: (props) => <Icon {...props} path={<><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/><path d="M8 14h.01"/><path d="M12 14h.01"/><path d="M16 14h.01"/><path d="M8 18h.01"/><path d="M12 18h.01"/><path d="M16 18h.01"/></>} />,
            X: (props) => <Icon {...props} path={<><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></>} />,
            Edit: (props) => <Icon {...props} path={<><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></>} />,
            CheckCircle: (props) => <Icon {...props} path={<><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></>} />,
            AlertTriangle: (props) => <Icon {...props} path={<><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></>} />
        };

        // --- Data & Main App ---

        const INITIAL_APPOINTMENTS = [
            { id: 1, title: '‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°‡∏ó‡∏µ‡∏° Marketing', date: '2023-10-25', time: '10:00', type: 'work' },
            { id: 2, title: '‡∏û‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ä‡∏≤‡∏¢)', date: '2023-10-26', time: '14:30', type: 'meeting' },
        ];

        const INITIAL_MESSAGES = [
            { id: 1, sender: 'bot', text: '‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏ú‡∏°‡∏Ñ‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢ \n‡∏û‡∏¥‡∏°‡∏û‡πå "‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ô‡∏±‡∏î" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà \n‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏•‡∏ö ‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö' }
        ];

        function App() {
            // --- State Management ---
            const [messages, setMessages] = useState(INITIAL_MESSAGES);
            const [inputValue, setInputValue] = useState('');
            const [appointments, setAppointments] = useState(INITIAL_APPOINTMENTS);
            
            // State Machine
            const [chatState, setChatState] = useState('IDLE'); 
            const [tempAppointment, setTempAppointment] = useState({ title: '', date: '', time: '' });
            
            // Edit State
            const [editingId, setEditingId] = useState(null);
            const [editingField, setEditingField] = useState(null); 

            // Delete Modal State (New)
            const [deleteModalOpen, setDeleteModalOpen] = useState(false);
            const [itemToDelete, setItemToDelete] = useState(null);

            const [isSidebarOpen, setIsSidebarOpen] = useState(false);
            const messagesEndRef = useRef(null);
            const inputRef = useRef(null);

            // Auto-scroll logic
            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
            };

            useEffect(() => {
                scrollToBottom();
            }, [messages]);

            // --- Logic Helpers ---

            const addMessage = (text, sender = 'bot') => {
                setMessages(prev => [...prev, { id: Date.now(), text, sender }]);
            };

            const handleSendMessage = (e) => {
                e.preventDefault();
                if (!inputValue.trim()) return;

                const userText = inputValue.trim();
                addMessage(userText, 'user');
                setInputValue('');

                setTimeout(() => {
                    processBotLogic(userText);
                }, 600);
            };

            const processBotLogic = (text) => {
                switch (chatState) {
                    case 'IDLE':
                        handleIdleState(text);
                        break;
                    case 'ASKING_TITLE':
                        setTempAppointment({ ...tempAppointment, title: text });
                        addMessage(`‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö‡∏Ñ‡∏£‡∏±‡∏ö ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏∑‡∏≠ "${text}" \n‡∏£‡∏∞‡∏ö‡∏∏ "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà" ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö (‡πÄ‡∏ä‡πà‡∏ô ‡∏û‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏µ‡πâ, 25 ‡∏ï.‡∏Ñ.)`);
                        setChatState('ASKING_DATE');
                        break;
                    case 'ASKING_DATE':
                        setTempAppointment(prev => ({ ...prev, date: text }));
                        addMessage(`‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${text} ‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö \n‡∏ô‡∏±‡∏î "‡∏Å‡∏µ‡πà‡πÇ‡∏°‡∏á" ‡∏Ñ‡∏£‡∏±‡∏ö?`);
                        setChatState('ASKING_TIME');
                        break;
                    case 'ASKING_TIME':
                        const newAppt = {
                            id: Date.now(),
                            title: tempAppointment.title,
                            date: tempAppointment.date,
                            time: text,
                            type: 'general'
                        };
                        setAppointments(prev => [...prev, newAppt]);
                        addMessage(`‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö: \nüìù ${newAppt.title} \nüìÖ ${newAppt.date} ‡πÄ‡∏ß‡∏•‡∏≤ ${text}`);
                        setChatState('IDLE');
                        setTempAppointment({ title: '', date: '', time: '' });
                        break;
                    case 'EDIT_SELECT_FIELD':
                        handleEditFieldSelection(text);
                        break;
                    case 'EDIT_NEW_VALUE':
                        handleEditValueUpdate(text);
                        break;
                    default:
                        addMessage('‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏±‡∏ö‡∏™‡∏ô‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ ‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö');
                        setChatState('IDLE');
                }
            };

            const handleIdleState = (text) => {
                const lowerText = text.toLowerCase();
                if (lowerText.includes('‡∏™‡∏£‡πâ‡∏≤‡∏á') || lowerText.includes('‡πÄ‡∏û‡∏¥‡πà‡∏°')) {
                    addMessage('‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà‡∏Ñ‡∏£‡∏±‡∏ö \n‡∏Ç‡∏≠‡∏ó‡∏£‡∏≤‡∏ö "‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢" ‡∏Ñ‡∏£‡∏±‡∏ö');
                    setChatState('ASKING_TITLE');
                } else if (lowerText.includes('‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç') || lowerText.includes('‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô')) {
                    addMessage('‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏î‡∏¥‡∏ô‡∏™‡∏≠" ‚úèÔ∏è ‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö');
                } else if (lowerText.includes('‡∏•‡∏ö')) {
                    addMessage('‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏ñ‡∏±‡∏á‡∏Ç‡∏¢‡∏∞" üóëÔ∏è ‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏ö‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö');
                } else if (lowerText.includes('‡∏î‡∏π') || lowerText.includes('‡∏ï‡∏≤‡∏£‡∏≤‡∏á')) {
                    addMessage(`‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ ${appointments.length} ‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö (‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤)`);
                    if(!isSidebarOpen && window.innerWidth < 768) setIsSidebarOpen(true);
                } else {
                    addMessage('‡∏ú‡∏°‡∏ä‡πà‡∏ß‡∏¢‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏•‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå "‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ô‡∏±‡∏î", "‡∏î‡∏π‡∏ï‡∏≤‡∏£‡∏≤‡∏á" ‡∏´‡∏£‡∏∑‡∏≠‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏±‡∏ö');
                }
            };

            const startEdit = (appt) => {
                setEditingId(appt.id);
                setChatState('EDIT_SELECT_FIELD');
                addMessage(`üîß ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: "${appt.title}"\n‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏´‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö? \n(‡∏û‡∏¥‡∏°‡∏û‡πå: ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠, ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà, ‡∏´‡∏£‡∏∑‡∏≠ ‡πÄ‡∏ß‡∏•‡∏≤)`);
                if(window.innerWidth < 768) setIsSidebarOpen(false);
                inputRef.current?.focus();
            };

            const handleEditFieldSelection = (text) => {
                const t = text.toLowerCase();
                if (t.includes('‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠') || t.includes('‡∏ä‡∏∑‡πà‡∏≠')) {
                    setEditingField('title');
                    addMessage('‡∏Ç‡∏≠‡∏ó‡∏£‡∏≤‡∏ö "‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÉ‡∏´‡∏°‡πà" ‡∏Ñ‡∏£‡∏±‡∏ö');
                    setChatState('EDIT_NEW_VALUE');
                } else if (t.includes('‡∏ß‡∏±‡∏ô')) {
                    setEditingField('date');
                    addMessage('‡∏Ç‡∏≠‡∏ó‡∏£‡∏≤‡∏ö "‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡∏°‡πà" ‡∏Ñ‡∏£‡∏±‡∏ö');
                    setChatState('EDIT_NEW_VALUE');
                } else if (t.includes('‡πÄ‡∏ß‡∏•‡∏≤') || t.includes('‡πÇ‡∏°‡∏á')) {
                    setEditingField('time');
                    addMessage('‡∏Ç‡∏≠‡∏ó‡∏£‡∏≤‡∏ö "‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏´‡∏°‡πà" ‡∏Ñ‡∏£‡∏±‡∏ö');
                    setChatState('EDIT_NEW_VALUE');
                } else if (t.includes('‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å')) {
                    addMessage('‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡∏£‡∏±‡∏ö');
                    setChatState('IDLE');
                    setEditingId(null);
                } else {
                    addMessage('‡∏ú‡∏°‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏•‡∏∑‡∏≠‡∏Å: ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠, ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà, ‡∏´‡∏£‡∏∑‡∏≠ ‡πÄ‡∏ß‡∏•‡∏≤ (‡∏´‡∏£‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å")');
                }
            };

            const handleEditValueUpdate = (newValue) => {
                setAppointments(prev => prev.map(appt => {
                    if (appt.id === editingId) {
                        return { ...appt, [editingField]: newValue };
                    }
                    return appt;
                }));
                addMessage(`‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö!`);
                setChatState('IDLE');
                setEditingId(null);
                setEditingField(null);
            };

            // --- Updated Delete Logic (Modal) ---

            const confirmDelete = (appt) => {
                setItemToDelete(appt);
                setDeleteModalOpen(true);
            };

            const executeDelete = () => {
                if (itemToDelete) {
                    setAppointments(prev => prev.filter(appt => appt.id !== itemToDelete.id));
                    addMessage(`üóëÔ∏è ‡∏•‡∏ö‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢ "${itemToDelete.title}" ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö`);
                    setDeleteModalOpen(false);
                    setItemToDelete(null);
                }
            };

            const cancelDelete = () => {
                setDeleteModalOpen(false);
                setItemToDelete(null);
            };

            // --- UI Rendering ---

            return (
                <div className="flex flex-col h-screen overflow-hidden relative">
                    
                    {/* --- Custom Delete Modal --- */}
                    {deleteModalOpen && (
                        <div className="absolute inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm fade-in p-4">
                            <div className="bg-white rounded-2xl shadow-xl w-full max-w-sm p-6 transform transition-all scale-100">
                                <div className="flex flex-col items-center text-center">
                                    <div className="bg-red-100 p-3 rounded-full mb-4">
                                        <Icons.AlertTriangle className="text-red-600 w-8 h-8" />
                                    </div>
                                    <h3 className="text-lg font-bold text-slate-800 mb-2">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö?</h3>
                                    <p className="text-slate-600 mb-6">
                                        ‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢ <br/>
                                        <span className="font-semibold text-slate-800">"{itemToDelete?.title}"</span> <br/>
                                        ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?
                                    </p>
                                    <div className="flex gap-3 w-full">
                                        <button 
                                            onClick={cancelDelete}
                                            className="flex-1 py-2.5 px-4 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-xl font-medium transition"
                                        >
                                            ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                                        </button>
                                        <button 
                                            onClick={executeDelete}
                                            className="flex-1 py-2.5 px-4 bg-red-600 hover:bg-red-700 text-white rounded-xl font-medium transition shadow-sm"
                                        >
                                            ‡∏•‡∏ö‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Header */}
                    <header className="bg-indigo-600 text-white p-4 shadow-md flex justify-between items-center z-10">
                        <div className="flex items-center gap-2">
                            <Icons.CalendarDays className="w-6 h-6" />
                            <h1 className="font-bold text-lg">Calendar Assistant</h1>
                        </div>
                        <button 
                            onClick={() => setIsSidebarOpen(!isSidebarOpen)}
                            className="md:hidden p-2 hover:bg-indigo-500 rounded-full transition"
                        >
                            {isSidebarOpen ? <Icons.X size={20} /> : <Icons.Calendar size={20} />}
                        </button>
                    </header>

                    <div className="flex flex-1 overflow-hidden relative">
                        {/* Chat Section */}
                        <div className="flex-1 flex flex-col w-full md:w-2/3 bg-white relative">
                            <div className="flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50">
                                {messages.map((msg) => (
                                    <div key={msg.id} className={`flex w-full ${msg.sender === 'user' ? 'justify-end' : 'justify-start'}`}>
                                        <div className={`flex max-w-[85%] md:max-w-[70%] items-start gap-2 ${msg.sender === 'user' ? 'flex-row-reverse' : 'flex-row'}`}>
                                            <div className={`w-8 h-8 rounded-full flex items-center justify-center shrink-0 ${msg.sender === 'user' ? 'bg-indigo-500 text-white' : 'bg-emerald-500 text-white'}`}>
                                                {msg.sender === 'user' ? <Icons.User size={16} /> : <Icons.Bot size={16} />}
                                            </div>
                                            <div className={`p-3 rounded-2xl shadow-sm text-sm md:text-base whitespace-pre-line leading-relaxed ${msg.sender === 'user' ? 'bg-indigo-600 text-white rounded-tr-none' : 'bg-white text-slate-700 border border-slate-200 rounded-tl-none'}`}>
                                                {msg.text}
                                            </div>
                                        </div>
                                    </div>
                                ))}
                                <div ref={messagesEndRef} />
                            </div>

                            <div className="p-4 bg-white border-t border-slate-100">
                                <form onSubmit={handleSendMessage} className="flex gap-2 max-w-4xl mx-auto">
                                    <input
                                        ref={inputRef}
                                        type="text"
                                        value={inputValue}
                                        onChange={(e) => setInputValue(e.target.value)}
                                        placeholder={chatState.startsWith('EDIT') ? (chatState === 'EDIT_SELECT_FIELD' ? "‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠, ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà, ‡∏´‡∏£‡∏∑‡∏≠ ‡πÄ‡∏ß‡∏•‡∏≤" : "‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà...") : "‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..."}
                                        className={`flex-1 border rounded-full px-4 py-3 focus:outline-none focus:ring-2 transition shadow-sm ${chatState.startsWith('EDIT') ? 'border-orange-300 focus:ring-orange-500 bg-orange-50' : 'border-slate-300 focus:ring-indigo-500'}`}
                                    />
                                    <button 
                                        type="submit" 
                                        disabled={!inputValue.trim()}
                                        className={`text-white p-3 rounded-full transition shadow-sm disabled:opacity-50 ${chatState.startsWith('EDIT') ? 'bg-orange-500 hover:bg-orange-600' : 'bg-indigo-600 hover:bg-indigo-700'}`}
                                    >
                                        {chatState.startsWith('EDIT') ? <Icons.Edit size={20} /> : <Icons.Send size={20} />}
                                    </button>
                                </form>
                            </div>
                        </div>

                        {/* Sidebar */}
                        <div className={`absolute inset-y-0 right-0 w-full md:w-1/3 bg-slate-100 border-l border-slate-200 transform transition-transform duration-300 ease-in-out z-20 md:relative md:translate-x-0 ${isSidebarOpen ? 'translate-x-0' : 'translate-x-full'}`}>
                            <div className="flex flex-col h-full">
                                <div className="p-4 bg-white border-b border-slate-200 flex justify-between items-center shadow-sm">
                                    <h2 className="font-semibold text-slate-700 flex items-center gap-2">
                                        <Icons.Calendar className="w-5 h-5 text-indigo-500" />
                                        ‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢ ({appointments.length})
                                    </h2>
                                </div>

                                <div className="flex-1 overflow-y-auto p-4 space-y-3">
                                    {appointments.length === 0 ? (
                                        <div className="text-center text-slate-400 mt-10">
                                            <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢</p>
                                        </div>
                                    ) : (
                                        appointments.map((appt) => (
                                            <div key={appt.id} className={`bg-white p-4 rounded-xl border shadow-sm transition group relative ${editingId === appt.id ? 'border-orange-400 ring-2 ring-orange-100' : 'border-slate-200 hover:shadow-md'}`}>
                                                {editingId === appt.id && <div className="absolute top-2 right-2 text-orange-500 text-xs font-bold animate-pulse">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç...</div>}
                                                <div className="flex justify-between items-start mb-2 pr-8">
                                                    <h3 className="font-bold text-slate-800 text-lg line-clamp-1">{appt.title}</h3>
                                                </div>
                                                <div className="space-y-1 text-sm text-slate-600 mb-3">
                                                    <div className="flex items-center gap-2"><Icons.Calendar size={14} className="text-indigo-500" /><span>{appt.date}</span></div>
                                                    <div className="flex items-center gap-2"><Icons.Clock size={14} className="text-orange-500" /><span>{appt.time} ‡∏ô.</span></div>
                                                </div>
                                                <div className="flex gap-2 border-t pt-3 mt-2 border-slate-100">
                                                    <button onClick={() => startEdit(appt)} disabled={chatState !== 'IDLE' && editingId !== appt.id} className="flex-1 flex items-center justify-center gap-1 py-1.5 rounded-lg text-sm font-medium text-slate-600 hover:bg-orange-50 hover:text-orange-600 transition disabled:opacity-30"><Icons.Edit size={16} /> ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                                                    <button onClick={() => confirmDelete(appt)} disabled={chatState !== 'IDLE'} className="flex-1 flex items-center justify-center gap-1 py-1.5 rounded-lg text-sm font-medium text-slate-600 hover:bg-red-50 hover:text-red-600 transition disabled:opacity-30"><Icons.Trash2 size={16} /> ‡∏•‡∏ö</button>
                                                </div>
                                            </div>
                                        ))
                                    )}
                                </div>

                                <div className="p-4 bg-slate-200/50 border-t border-slate-200">
                                    <button onClick={() => { setInputValue('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ô‡∏±‡∏î'); setIsSidebarOpen(false); inputRef.current?.focus(); }} disabled={chatState !== 'IDLE'} className="w-full bg-white border border-indigo-200 text-indigo-600 py-2 rounded-lg font-medium hover:bg-indigo-50 transition flex items-center justify-center gap-2 disabled:opacity-50"><Icons.PlusCircle size={18} /> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÉ‡∏´‡∏°‡πà</button>
                                </div>
                            </div>
                        </div>

                        {isSidebarOpen && <div className="absolute inset-0 bg-black/20 z-10 md:hidden" onClick={() => setIsSidebarOpen(false)}></div>}
                    </div>
                </div>
            );
        }

        // Render the App
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
